
# basic stuff
set -g default-terminal "screen-256color"
set -g base-index 1
set -g pane-base-index 1
set -s escape-time 1

# copy and paster
set -g default-command "bash"
set -g set-clipboard on

# mouse
set -g mouse on

# pane titles
set -g set-titles on
set -g set-titles-string "#T"

# key bindings

unbind C-b
set -g prefix å
set -g prefix2 C-Space

bind -n M-Left  select-pane -U
bind -n M-Right select-pane -D
bind -n M-Up    select-pane -U
bind -n M-Down  select-pane -D

bind -n M-Left  run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys Escape \\\\ h) || tmux select-pane -L"
bind -n M-Right run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys Escape \\\\ l) || tmux select-pane -R"
bind -n M-Up    run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys Escape \\\\ k) || tmux select-pane -U"
bind -n M-Down  run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys Escape \\\\ j) || tmux select-pane -D"
bind -n M-\     run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys 'C-\\') || tmux select-pane -l"

bind Space split-window -h -c '#{pane_current_path}'
bind C-Space split-window -c '#{pane_current_path}'

bind -n M-d split-window -h -c '#{pane_current_path}'
bind -n M-D split-window -c '#{pane_current_path}'
bind -n M-s run "tmux split-window -h -c '#{pane_current_path}' && tmux swap-pane -U"
bind -n M-S run "tmux split-window -c '#{pane_current_path}' && tmux swap-pane -U"
bind -n M-f run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys Escape C-w v C-w l) || tmux split-window -h -c '#{pane_current_path}'"
bind -n M-F run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys Escape C-w s C-w j) || tmux split-window -c '#{pane_current_path}'"

bind -n M-t run-shell "tmux new-window -t +1 || tmux next-window"
bind -n M-Tab last-pane

bind -r Left  resize-pane -L
bind -r Right resize-pane -R
bind -r Up    resize-pane -U
bind -r Down  resize-pane -D

bind -n Ω resize-pane -Z
bind Ω resize-pane -Z

bind 1 run "tmux select-window -t :1 || tmux new-window -t :1"
bind 2 run "tmux select-window -t :2 || tmux new-window -t :2"
bind 3 run "tmux select-window -t :3 || tmux new-window -t :3"
bind 4 run "tmux select-window -t :4 || tmux new-window -t :4"
bind 5 run "tmux select-window -t :5 || tmux new-window -t :5"
bind 6 run "tmux select-window -t :6 || tmux new-window -t :6"
bind 7 run "tmux select-window -t :7 || tmux new-window -t :7"
bind 8 run "tmux select-window -t :8 || tmux new-window -t :8"
bind 9 run "tmux select-window -t :9 || tmux new-window -t :9"

bind -n M-1 run "tmux select-window -t :1 || tmux new-window -t :1"
bind -n M-2 run "tmux select-window -t :2 || tmux new-window -t :2"
bind -n M-3 run "tmux select-window -t :3 || tmux new-window -t :3"
bind -n M-4 run "tmux select-window -t :4 || tmux new-window -t :4"
bind -n M-5 run "tmux select-window -t :5 || tmux new-window -t :5"
bind -n M-6 run "tmux select-window -t :6 || tmux new-window -t :6"
bind -n M-7 run "tmux select-window -t :7 || tmux new-window -t :7"
bind -n M-8 run "tmux select-window -t :8 || tmux new-window -t :8"
bind -n M-9 run "tmux select-window -t :9 || tmux new-window -t :9"

bind 0 run "tmux new-window -t :0 'rtop --set-tmux-title' || tmux select-window -t :0"
bind -n M-0 run "tmux new-window -t :0 'rtop --set-tmux-title' || tmux select-window -t :0"

# TODO:
# run-shell ~/Dropbox/Config/tmux-scroll-copy-mode/scroll_copy_mode.tmux

# nice powerline

run {

    function st() {
        tmux set -g "$@"
    }

    C_REGULAR_FG="colour21"
    C_REGULAR_BG="colour19"

    C_LIGHTER_FG="colour20"
    C_LIGHTER_BG="colour18"

    C_SPECIAL_FG="colour18"
    C_SPECIAL_BG="colour2"

    CR="#[fg=$C_REGULAR_FG,bg=$C_REGULAR_BG]"
    CS="#[fg=$C_SPECIAL_FG,bg=$C_SPECIAL_BG]"
    CL="#[fg=$C_LIGHTER_FG,bg=$C_LIGHTER_BG]"

    CRL="#[fg=$C_REGULAR_BG,bg=$C_LIGHTER_BG,nobold,nounderscore,noitalics]"
    CSR="#[fg=$C_SPECIAL_BG,bg=$C_REGULAR_BG,nobold,nounderscore,noitalics]"
    CLS="#[fg=$C_LIGHTER_BG,bg=$C_SPECIAL_BG,nobold,nounderscore,noitalics]"
    CSL="#[fg=$C_SPECIAL_BG,bg=$C_LIGHTER_BG,nobold,nounderscore,noitalics]"

    SL=$'\356\202\260' # \uE0B0 
    AL=$'\356\202\261' # \uE0B1 
    SR=$'\356\202\262' # \uE0B2 
    AR=$'\356\202\263' # \uE0B2 

    st pane-active-border-style "fg=$C_LIGHTER_BG"
    st pane-border-style "fg=$C_LIGHTER_BG"

    st status 'on'
    st status-bg "$C_LIGHTER_BG"
    st status-right-length '100'
    st status-right "$CRL$SR$CR ##{pane_title} $CSR$SR$CS ##S "
    st status-left "$CR %H:%M $CRL$SL"

    st window-status-format "$CL ##I  ##W "
    st window-status-current-format "$CLS$SL$CS ##I  ##W $CSL$SL"
    st window-status-separator ''
}

# vi: ft=tmux
